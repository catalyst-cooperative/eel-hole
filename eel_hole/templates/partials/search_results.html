{% for r in resources %}
<div class="block" data-testid="{{r.name}}">
    <div class="level">
        <div class="level-left">
            <h2 class="title is-4 level-item" data-testid="metadata-table-name">
                {{r.name}}
            </h2>
        </div>
    </div>
    <div class="level">
        <div class="level-left">
            <span class="tag level-item">package: {{ r.package }}</span>
        </div>
    </div>
    {% if r.package == "pudl" %}
    <div class="block">
        {% if current_user.is_authenticated or config['LOGIN_DISABLED'] %}
        <a
            class="button is-primary preview-button"
            href="/preview/{{ r.package }}/{{ r.name }}"
            hx-get="/preview/{{ r.package }}/{{ r.name }}"
            hx-target="#main-content"
            hx-push-url="true"
            onclick="
                if (event.ctrlKey || event.metaKey || event.shiftKey) {
                    event.stopImmediatePropagation();
                    return;
                }
            "
            >Preview / export as CSV</a
        >
        {% else %}
        <a
            class="button is-primary preview-button"
            href="/login?next_url={{ url_for(request.endpoint, **request.args) }}"
            >Log in or sign up to preview / export as CSV</a
        >
        {% endif %}
        <a
            class="button is-link is-light"
            href="https://s3.us-west-2.amazonaws.com/pudl.catalyst.coop/nightly/{{ r.name }}.parquet"
            >Download full table as Parquet</a
        >
    </div>
    {% endif %}
    <div class="level">{{r.description | safe}}</div>
    <div class="block">
        <details>
            <summary class="title is-5">Columns</summary>
            {% for col in r.columns %}
            <div class="mb-2" data-testid="column">
                <div>
                    <strong>{{ col.name }}</strong>
                </div>
                <div class="pl-4">{{ col.description | safe }}</div>
            </div>
            {% endfor %}
        </details>
    </div>
</div>
{% endfor %}
